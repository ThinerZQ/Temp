<html>
<head>
  <title>进程与线程及其区别</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/272632; Windows/6.1.7601 Service Pack 1;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="1033"/>
<h1>进程与线程及其区别</h1>

<div>
<div><ol><li style="margin: 0cm 0cm 0pt; color: #666666; font-family: 宋体, Arial; font-size: 16px;"><strong>进程和线程</strong></li></ol><h2 style="margin: 0cm 0cm 0pt; color: #666666; font-family: 宋体, Arial;">1.1 概述:</h2><p style="margin: 0cm 0cm 0pt; color: #666666; font-family: 宋体, Arial; font-size: 16px;"><span style="font-size: 12pt; font-family: 宋体;">进程是具有一定独立功能的程序关于某个数据集合上的一次运行活动</span><span style="font-size: 12pt;">,</span><span style="font-size: 12pt;">进程是系统进行资源分配和调度的一个独立单位</span><span style="font-size: 12pt;">.</span></p><p style="margin: 0cm 0cm 0pt; color: #666666; font-family: 宋体, Arial; font-size: 16px;"><span style="font-size: 12pt; font-family: 宋体;">线程是进程的一个实体</span><span style="font-size: 12pt;">,</span><span style="font-size: 12pt;">是</span><span style="font-size: 12pt;">CPU</span><span style="font-size: 12pt;">调度和分派的基本单位</span><span style="font-size: 12pt;">,</span><span style="font-size: 12pt;">它是比进程更小的能独立运行的基本单位</span><span style="font-size: 12pt;">.</span><span style="font-size: 12pt;">线程自己基本上不拥有系统资源</span><span style="font-size: 12pt;">,</span><span style="font-size: 12pt;">只拥有一点在运行中必不可少的资源</span><span style="font-size: 12pt;">(</span><span style="font-size: 12pt;">如程序计数器</span><span style="font-size: 12pt;">,</span><span style="font-size: 12pt;">一组寄存器和栈</span><span style="font-size: 12pt;">),</span><span style="font-size: 12pt;">但是它可与同属一个进程的其他的线程共享进程所拥有的全部资源</span><span style="font-size: 12pt;">.</span></p><p style="margin: 0cm 0cm 0pt; color: #666666; font-family: 宋体, Arial; font-size: 16px;"><span style="font-size: 12pt; font-family: 宋体;">一个线程可以创建和撤销另一个线程</span><span style="font-size: 12pt;">;</span><span style="font-size: 12pt;">同一个进程中的多个线程之间可以并发执行</span><span style="font-size: 12pt;">.</span></p><p style="margin: 0cm 0cm 0pt; color: #666666; font-family: 宋体, Arial; font-size: 16px;"><span style="font-size: 12pt; font-family: 宋体;">相对进程而言，线程是一个更加接近于执行体的概念，它可以与同进程中的其他线程共享数据，但拥有自己的栈空间，拥有独立的执行序列。</span></p><p style="margin: 0cm 0cm 0pt; color: #666666; font-family: 宋体, Arial; font-size: 16px;"><span style="font-size: 12pt; font-family: 宋体;">在串行程序基础上引入线程和进程是为了提高程序的并发度，从而提高程序运行效率和响应时间。</span></p><h2 style="margin: 0cm 0cm 0pt; color: #666666; font-family: 宋体, Arial;">1.2 区别:</h2><p style="margin: 0cm 0cm 0pt; color: #666666; font-family: 宋体, Arial; font-size: 16px;"><span style="font-size: 12pt; font-family: 宋体;">进程和线程的主要差别在于它们是不同的操作系统资源管理方式。进程有独立的地址空间，一个进程崩溃后，在保护模式下不会对其它进程产生影响，而线程只是一个进程中的不同执行路径。线程有自己的堆栈和局部变量，但线程之间没有单独的地址空间，一个线程死掉就等于整个进程死掉，所以多进程的程序要比多线程的程序健壮，但在进程切换时，耗费资源较大，效率要差一些。<strong>但对于一些要求同时进行并且又要共享某些变量的并发操作，只能用线程，不能用进程。</strong></span></p><p style="margin: 0cm 0cm 0pt; color: #666666; font-family: 宋体, Arial; font-size: 16px;"><strong><span style="font-size: 12pt;">1) </span></strong><strong><span style="font-size: 12pt;">简而言之</span></strong><strong><span style="font-size: 12pt;">,</span></strong><strong><span style="font-size: 12pt;">一个程序至少有一个进程</span></strong><strong><span style="font-size: 12pt;">,</span></strong><strong><span style="font-size: 12pt;">一个进程至少有一个线程</span></strong><strong><span style="font-size: 12pt;">.</span></strong></p><p style="margin: 0cm 0cm 0pt; color: #666666; font-family: 宋体, Arial; font-size: 16px;"><span style="font-size: 12pt;">2) </span><span style="font-size: 12pt;">线程的划分尺度小于进程，使得多线程程序的并发性高。</span></p><p style="margin: 0cm 0cm 0pt; color: #666666; font-family: 宋体, Arial; font-size: 16px;"><span style="font-size: 12pt;">3) </span><span style="font-size: 12pt;">另外，进程在执行过程中拥有独立的内存单元，而多个线程共享内存，从而极大地提高了程序的运行效率。</span></p><p style="margin: 0cm 0cm 0pt; color: #666666; font-family: 宋体, Arial; font-size: 16px;"><span style="font-size: 12pt;">4) </span><span style="font-size: 12pt; font-family: 宋体;">线程在执行过程中与进程还是有区别的。每个独立的线程有一个程序运行的入口、顺序执行序列和程序的出口。<strong>但是线程不能够独立执行，</strong>必须依存在应用程序中，由应用程序提供多个线程执行控制。</span></p><p style="margin: 0cm 0cm 0pt; color: #666666; font-family: 宋体, Arial; font-size: 16px;"><span style="font-size: 12pt;">5) </span><span style="font-size: 12pt; font-family: 宋体;">从逻辑角度来看，多线程的意义在于一个应用程序中，有多个执行部分可以同时执行。但操作系统并没有将多个线程看做多个独立的应用，来实现进程的调度和管理以及资源分配。<strong>这就是进程和线程的重要区别。</strong></span></p><h2 style="margin: 0cm 0cm 0pt; color: #666666; font-family: 宋体, Arial;">1.3 优缺点:</h2><p style="margin: 0cm 0cm 0pt; color: #666666; font-family: 宋体, Arial; font-size: 16px;"><span style="font-size: 12pt; font-family: 宋体;">线程和进程在使用上各有优缺点：线程执行开销小，但不利于资源的管理和保护；而进程正相反。同时，线程适合于在</span><span style="font-size: 12pt;">SMP</span><span style="font-size: 12pt;">机器上运行，而进程则可以跨机器迁移。</span></p><ol start="2"><li style="margin: 0cm 0cm 0pt; color: #666666; font-family: 宋体, Arial; font-size: 16px;"><strong>多进程，多线程</strong></li></ol><h2 style="margin: 0cm 0cm 0pt; color: #666666; font-family: 宋体, Arial;">2.1 概述:</h2><p style="margin: 0cm 0cm 0pt; color: #666666; font-family: 宋体, Arial; font-size: 16px;"><span style="font-size: 12pt; font-family: 宋体;">进程就是一个程序运行的时候被</span><span style="font-size: 12pt;">CPU</span><span style="font-size: 12pt;">抽象出来的，一个程序运行后被抽象为一个进程，但是线程是从一个进程里面分割出来的，由于</span><span style="font-size: 12pt;">CPU</span><span style="font-size: 12pt;">处理进程的时候是采用时间片轮转的方式，所以要把一个大个进程给分割成多个线程，例如：网际快车中文件分成</span><span style="font-size: 12pt;">100</span><span style="font-size: 12pt;">部分</span><span style="font-size: 12pt;"> 10</span><span style="font-size: 12pt;">个线程</span><span style="font-size: 12pt;"> </span><span style="font-size: 12pt;">文件就被分成了</span><span style="font-size: 12pt;">10</span><span style="font-size: 12pt;">份来同时下载</span><span style="font-size: 12pt;"> 1-10 </span><span style="font-size: 12pt;">占一个线程</span><span style="font-size: 12pt;"> 11-20</span><span style="font-size: 12pt;">占一个线程</span><span style="font-size: 12pt;">,</span><span style="font-size: 12pt;">依次类推</span><span style="font-size: 12pt;">,</span><span style="font-size: 12pt;">线程越多</span><span style="font-size: 12pt;">,</span><span style="font-size: 12pt;">文件就被分的越多</span><span style="font-size: 12pt;">,</span><span style="font-size: 12pt;">同时下载</span><span style="font-size: 12pt;"> </span><span style="font-size: 12pt;">当然速度也就越快</span></p><p style="margin: 0cm 0cm 0pt; color: #666666; font-family: 宋体, Arial; font-size: 16px;"><strong><span style="font-size: 12pt; font-family: 宋体;">进程是程序在计算机上的一次执行活动。</span></strong><span style="font-size: 12pt; font-family: 宋体;">当你运行一个程序，你就启动了一个进程。显然，程序只是一组指令的有序集合，它本身没有任何运行的含义，只是一个静态实体。而进程则不同，它是程序在某个数据集上的执行，是一个动态实体。它因创建而产生，因调度而运行，因等待资源或事件而被处于等待状态，因完成任务而被撤消，反映了一个程序在一定的数据集上运行的全部动态过程。<strong>进程是操作系统分配资源的单位。</strong>在</span><span style="font-size: 12pt;">Windows</span><span style="font-size: 12pt;">下，进程又被细化为线程，也就是一个进程下有多个能独立运行的更小的单位。<strong>线程</strong></span><strong><span style="font-size: 12pt;">(Thread)</span></strong><strong><span style="font-size: 12pt;">是进程的一个实体，是</span></strong><strong><span style="font-size: 12pt;">CPU</span></strong><strong><span style="font-size: 12pt;">调度和分派的基本单位。</span></strong><span style="font-size: 12pt; font-family: 宋体;">线程不能够独立执行，必须依存在应用程序中，由应用程序提供多个线程执行控制。</span></p><p style="margin: 0cm 0cm 0pt; color: #666666; font-family: 宋体, Arial; font-size: 16px;"><strong><span style="font-size: 12pt; font-family: 宋体;">线程和进程的关系是：</span></strong><span style="font-size: 12pt; font-family: 宋体;">线程是属于进程的，线程运行在进程空间内，同一进程所产生的线程共享同一内存空间，当进程退出时该进程所产生的线程都会被强制退出并清除。线程可与属于同一进程的其它线程共享进程所拥有的全部资源，但是其本身基本上不拥有系统资源，只拥有一点在运行中必不可少的信息</span><span style="font-size: 12pt;">(</span><span style="font-size: 12pt;">如程序计数器、一组寄存器和栈</span><span style="font-size: 12pt;">)</span><span style="font-size: 12pt;">。</span></p><p style="margin: 0cm 0cm 0pt; color: #666666; font-family: 宋体, Arial; font-size: 16px;"><span style="font-size: 12pt; font-family: 宋体;">在同一个时间里，同一个计算机系统中如果允许两个或两个以上的进程处于运行状态，这便是多任务。现代的操作系统几乎都是多任务操作系统，能够同时管理多个进程的运行。</span><span style="font-size: 12pt;"> </span><span style="font-size: 12pt;">多任务带来的好处是明显的，比如你可以边听</span><span style="font-size: 12pt;">mp3</span><span style="font-size: 12pt;">边上网，与此同时甚至可以将下载的文档打印出来，而这些任务之间丝毫不会相互干扰。那么这里就涉及到并行的问题，俗话说，一心不能二用，这对计算机也一样，原则上一个</span><span style="font-size: 12pt;">CPU</span><span style="font-size: 12pt;">只能分配给一个进程，以便运行这个进程。我们通常使用的计算机中只有一个</span><span style="font-size: 12pt;">CPU</span><span style="font-size: 12pt;">，也就是说只有一颗心，要让它一心多用，同时运行多个进程，就必须使用并发技术。实现并发技术相当复杂，<strong>最容易理解的是“时间片轮转进程调度算法”，</strong>它的思想简单介绍如下：在操作系统的管理下，所有正在运行的进程轮流使用</span><span style="font-size: 12pt;">CPU</span><span style="font-size: 12pt;">，每个进程允许占用</span><span style="font-size: 12pt;">CPU</span><span style="font-size: 12pt;">的时间非常短</span><span style="font-size: 12pt;">(</span><span style="font-size: 12pt;">比如</span><span style="font-size: 12pt;">10</span><span style="font-size: 12pt;">毫秒</span><span style="font-size: 12pt;">)</span><span style="font-size: 12pt;">，这样用户根本感觉不出来</span><span style="font-size: 12pt;">CPU</span><span style="font-size: 12pt;">是在轮流为多个进程服务，就好象所有的进程都在不间断地运行一样。但实际上在任何一个时间内有且仅有一个进程占有</span><span style="font-size: 12pt;">CPU</span><span style="font-size: 12pt;">。</span></p><p style="margin: 0cm 0cm 0pt; color: #666666; font-family: 宋体, Arial; font-size: 16px;"><span style="font-size: 12pt; font-family: 宋体;">如果一台计算机有多个</span><span style="font-size: 12pt;">CPU</span><span style="font-size: 12pt;">，情况就不同了，如果进程数小于</span><span style="font-size: 12pt;">CPU</span><span style="font-size: 12pt;">数，则不同的进程可以分配给不同的</span><span style="font-size: 12pt;">CPU</span><span style="font-size: 12pt;">来运行，这样，多个进程就是真正同时运行的，这便是并行。但如果进程数大于</span><span style="font-size: 12pt;">CPU</span><span style="font-size: 12pt;">数，则仍然需要使用并发技术。</span></p><p style="margin: 0cm 0cm 0pt; color: #666666; font-family: 宋体, Arial; font-size: 16px;"><strong><span style="font-size: 12pt; font-family: 宋体;">在</span></strong><strong><span style="font-size: 12pt;">Windows</span></strong><strong><span style="font-size: 12pt;">中，进行</span></strong><strong><span style="font-size: 12pt;">CPU</span></strong><strong><span style="font-size: 12pt;">分配是以线程为单位的，</span></strong><span style="font-size: 12pt;">一个进程可能由多个线程组成，这时情况更加复杂，但简单地说，有如下关系：</span></p><p style="margin: 0cm 0cm 0pt; color: #666666; font-family: 宋体, Arial; font-size: 16px;"><span style="font-size: 12pt; font-family: 宋体;">总线程数</span><span style="font-size: 12pt;">&lt;= CPU</span><span style="font-size: 12pt;">数量：并行运行</span></p><p style="margin: 0cm 0cm 0pt; color: #666666; font-family: 宋体, Arial; font-size: 16px;"><span style="font-size: 12pt; font-family: 宋体;">总线程数</span><span style="font-size: 12pt;">&gt; CPU</span><span style="font-size: 12pt;">数量：并发运行</span></p><p style="margin: 0cm 0cm 0pt; color: #666666; font-family: 宋体, Arial; font-size: 16px;"><span style="font-size: 12pt; font-family: 宋体;">并行运行的效率显然高于并发运行，所以在多</span><span style="font-size: 12pt;">CPU</span><span style="font-size: 12pt;">的计算机中，多任务的效率比较高。但是，如果在多</span><span style="font-size: 12pt;">CPU</span><span style="font-size: 12pt;">计算机中只运行一个进程</span><span style="font-size: 12pt;">(</span><span style="font-size: 12pt;">线程</span><span style="font-size: 12pt;">)</span><span style="font-size: 12pt;">，就不能发挥多</span><span style="font-size: 12pt;">CPU</span><span style="font-size: 12pt;">的优势。</span></p><p style="margin: 0cm 0cm 0pt; color: #666666; font-family: 宋体, Arial; font-size: 16px;"><span style="font-size: 12pt;"> </span><span style="font-size: 12pt;">多任务操作系统</span><span style="font-size: 12pt;">(</span><span style="font-size: 12pt;">如</span><span style="font-size: 12pt;">Windows)</span><span style="font-size: 12pt;">的基本原理是</span><span style="font-size: 12pt;">:</span><span style="font-size: 12pt;">操作系统将</span><span style="font-size: 12pt;">CPU</span><span style="font-size: 12pt;">的时间片分配给多个线程</span><span style="font-size: 12pt;">,</span><span style="font-size: 12pt;">每个线程在操作系统指定的时间片内完成</span><span style="font-size: 12pt;">(</span><span style="font-size: 12pt;">注意</span><span style="font-size: 12pt;">,</span><span style="font-size: 12pt;">这里的多个线程是分属于不同进程的</span><span style="font-size: 12pt;">).</span><span style="font-size: 12pt;">操作系统不断的从一个线程的执行切换到另一个线程的执行</span><span style="font-size: 12pt;">,</span><span style="font-size: 12pt;">如此往复</span><span style="font-size: 12pt;">,</span><span style="font-size: 12pt;">宏观上看来</span><span style="font-size: 12pt;">,</span><span style="font-size: 12pt;">就好像是多个线程在一起执行</span><span style="font-size: 12pt;">.</span><span style="font-size: 12pt;">由于这多个线程分属于不同的进程</span><span style="font-size: 12pt;">,</span><span style="font-size: 12pt;">因此在我们看来</span><span style="font-size: 12pt;">,</span><span style="font-size: 12pt;">就好像是多个进程在同时执行</span><span style="font-size: 12pt;">,</span><span style="font-size: 12pt;">这样就实现了多任务</span><span style="font-size: 12pt;">.</span></p><h2 style="margin: 0cm 0cm 0pt; color: #666666; font-family: 宋体, Arial;"> 2.2 分类</h2><p style="margin: 0cm 0cm 0pt; color: #666666; font-family: 宋体, Arial; font-size: 16px;"><span style="font-size: 12pt; font-family: 宋体;">根据进程与线程的设置，操作系统大致分为如下类型：</span></p><p style="margin: 0cm 0cm 0pt; color: #666666; font-family: 宋体, Arial; font-size: 16px;"><span style="font-size: 12pt;">(1) </span><span style="font-size: 12pt;">单进程、单线程，</span><span style="font-size: 12pt;">MS-DOS</span><span style="font-size: 12pt;">大致是这种操作系统；</span></p><p style="margin: 0cm 0cm 0pt; color: #666666; font-family: 宋体, Arial; font-size: 16px;"><span style="font-size: 12pt;">(2) </span><span style="font-size: 12pt;">多进程、单线程，多数</span><span style="font-size: 12pt;">UNIX(</span><span style="font-size: 12pt;">及类</span><span style="font-size: 12pt;">UNIX</span><span style="font-size: 12pt;">的</span><span style="font-size: 12pt;">LINUX)</span><span style="font-size: 12pt;">是这种操作系统；</span></p><p style="margin: 0cm 0cm 0pt; color: #666666; font-family: 宋体, Arial; font-size: 16px;"><span style="font-size: 12pt;">(3) </span><span style="font-size: 12pt;">多进程、多线程，</span><span style="font-size: 12pt;">Win32(Windows NT/2000/XP</span><span style="font-size: 12pt;">等</span><span style="font-size: 12pt;">)</span><span style="font-size: 12pt;">、</span><span style="font-size: 12pt;">Solaris 2.x</span><span style="font-size: 12pt;">和</span><span style="font-size: 12pt;">OS/2</span><span style="font-size: 12pt;">都是这种操作系统；</span></p><p style="margin: 0cm 0cm 0pt; color: #666666; font-family: 宋体, Arial; font-size: 16px;"><span style="font-size: 12pt;">(4) </span><span style="font-size: 12pt;">单进程、多线程，</span><span style="font-size: 12pt;">VxWorks</span><span style="font-size: 12pt;">是这种操作系统。</span></p><h2 style="margin: 0cm 0cm 0pt; color: #666666; font-family: 宋体, Arial;">2.3 引入线程带来的主要好处：</h2><p style="margin: 0cm 0cm 0pt; color: #666666; font-family: 宋体, Arial; font-size: 16px;"><span style="font-size: 12pt;">(1) </span><span style="font-size: 12pt;">在进程内创建、终止线程比创建、终止进程要快；</span></p><p style="margin: 0cm 0cm 0pt; color: #666666; font-family: 宋体, Arial; font-size: 16px;"><span style="font-size: 12pt;">(2) </span><span style="font-size: 12pt;">同一进程内的线程间切换比进程间的切换要快</span><span style="font-size: 12pt;">,</span><span style="font-size: 12pt;">尤其是用户级线程间的切换。</span></p></div>
</div></body></html> 